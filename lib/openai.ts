import OpenAI from 'openai'

export const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
})

export const EXTRACT_PROMPT = `
คุณคือผู้ช่วยอ่านเอกสารราชการไทย

จากภาพเอกสารที่ให้มา ให้สกัดข้อมูลต่อไปนี้แล้วตอบเป็น JSON เท่านั้น ห้ามมี text อื่น:

{
  "title": "ชื่อโครงการหรือหัวข้อการประชุม (กระชับ ชัดเจน)",
  "dates": [
    {
      "startDateTime": "วันที่และเวลาเริ่มต้น ในรูปแบบ ISO 8601 เช่น 2025-03-15T09:00:00",
      "endDateTime": "วันที่และเวลาสิ้นสุด ในรูปแบบ ISO 8601 (ถ้าไม่มีให้ประมาณ startDateTime + 2 ชั่วโมง)"
    }
  ],
  "location": "สถานที่จัดงาน",
  "description": "สรุปสิ่งที่ต้องเตรียม, เบอร์โทรผู้ประสานงาน, หมายเหตุสำคัญ"
}

กฎสำคัญเรื่องวันที่:
- ถ้าเอกสารระบุวันที่หลายวันที่ไม่ต่อเนื่องกัน เช่น "วันที่ 1 และ 5 มกราคม 2569" ให้ใส่ใน dates เป็น 2 รายการแยกกัน
- ถ้าเอกสารระบุวันที่ต่อเนื่องกัน เช่น "วันที่ 1-3 มกราคม 2569" ให้ใส่ใน dates เป็น 1 รายการ (startDateTime = วันแรก, endDateTime = วันสุดท้าย + เวลาสิ้นสุด)
- ถ้ามีทั้งวันต่อเนื่องและไม่ต่อเนื่อง เช่น "1-2 มกราคม 2569 และ 7 มกราคม 2569" ให้แยกเป็น 2 รายการ
- ถ้าเอกสารระบุเพียงวันเดียว ให้ใส่ใน dates เป็น 1 รายการ

กฎสำคัญเรื่องปี:
- เอกสารราชการไทยใช้ปี พ.ศ. (พุทธศักราช) เสมอ เช่น 2568, 2569
- ต้องแปลงปี พ.ศ. → ค.ศ. ทุกครั้ง โดย ค.ศ. = พ.ศ. - 543
- ตัวอย่าง: พ.ศ. 2568 → ค.ศ. 2025, พ.ศ. 2569 → ค.ศ. 2026
- ถ้าเอกสารเขียนปีแบบย่อ เช่น "68" หรือ "69" ให้แปลงเป็น พ.ศ. 2568, 2569 ก่อน แล้วลบ 543
- ห้ามใช้ตัวเลขปีจากเอกสารโดยตรงโดยไม่แปลง

กฎอื่นๆ:
- ถ้าไม่มีข้อมูลให้ใส่ string ว่าง "" (ยกเว้น dates ต้องมีอย่างน้อย 1 รายการ)
- ห้ามเดาข้อมูลที่ไม่มีในเอกสาร
- ตอบเป็น JSON ล้วน ไม่มี markdown code block
`

export interface DateRange {
  startDateTime: string
  endDateTime: string
}

export interface EventData {
  title: string
  dates: DateRange[]
  location: string
  description: string
}
